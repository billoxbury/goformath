gain <-  function(period){
sum(
invest * (1 + rate/100)^period  - invest
)
}
( g <- sapply(period, gain) )
diff(g)
period <- (1:12)/12
# compute gain
gain <-  function(period){
sum(
invest * (1 + rate/100)^period  - invest
)
}
( g <- sapply(period, gain) )
diff(g)
bank <- c('Nationwide',   # instant access DONE
'Chase-A',        # instant access DONE
'Chase-B',        # instant access DONE
'Paragon120',      # 120 days
'ParagonTriple',  # instant access DONE
'OakNorth',     # 120 days
'Investec',     # instant access DONE
'Yorkshire')     # instant access DONE
# actual
rate <- c(2.25,
2.7,
2.7,
2.86,
2.81,
3.35,
2.42,
2.9)
invest <- c(84,80,80,2,80,120,74,180)
sum(invest)
# compute gain
gain <-  function(period){
sum(
invest * (1 + rate/100)^period  - invest
)
}
( g <- sapply(period, gain) )
diff(g)
invest <- c(80,80,80,2,80,120,80,180)
sum(invest)
( g <- sapply(period, gain) )
diff(g)
# actual
rate <- c(2.25,
2.7,
2.7,
2.86,
2.81,
3.35,
2.42,
2.9)
invest <- c(80,0,80,2,160,120,80,160)
sum(invest)
invest <- c(95,0,80,2,160,120,80,160)
sum(invest)
invest <- c(100,0,80,2,160,120,80,160)
sum(invest)
# compute gain
gain <-  function(period){
sum(
invest * (1 + rate/100)^period  - invest
)
}
( g <- sapply(period, gain) )
diff(g)
invest <- c(20,80,80,2,160,120,80,160)
sum(invest)
( g <- sapply(period, gain) )
diff(g)
invest <- c(18,80,80,2,160,120,80,160)
sum(invest)
( g <- sapply(period, gain) )
diff(g)
80000 + 79000 + 163000 + 180000 + 165000
sample(6)
sample(6,1)
sample(6,1)
sample(6,1)
sample(6,1)
n <- 100
a <- 0
b <- n
i <- sample(a+b, 1)
i
a <- 0
b <- n
while(a+b > 0){
i <- sample(a+b, 1)
if(i > a){
a <- a+1
b <- b-1
} else {
a <- a-1
}
cat(sprintf("%d %d", a,b))
}
a <- 0
b <- n
while(a+b > 0){
i <- sample(a+b, 1)
if(i > a){
a <- a+1
b <- b-1
} else {
a <- a-1
}
cat(sprintf("%d\t%d\n", a,b))
}
n <- 100
a <- 0
b <- n
while(a+b > 0){
i <- sample(a+b, 1)
if(i > a){
a <- a+1
b <- b-1
} else {
a <- a-1
}
p <- a/(a+b)
cat(sprintf("%g\n", p))
}
p <- c()
a <- 0
b <- n
p <- c()
while(a+b > 0){
i <- sample(a+b, 1)
if(i > a){
a <- a+1
b <- b-1
} else {
a <- a-1
}
p <- c(p,a/(a+b))
}
plot(p, type='l', col='blue')
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
78.05 * 4 + 58
# current interest rates
rate <- c(4.5,
4.2,
2.5,
3.8,
4.42,
3.84,
4.25,
4.41)
# current balances
invest <- c(1.75,
79.9,
1.0,
57.564,
81.1,
164.617,
165.797,
160)
sum(invest)
PERIOD <- (1:12)/12
# compute gain
gain <-  function(period){
sum(
invest * (1 + rate/100)^period  - invest
)
}
( g <- sapply(PERIOD, gain) )
# current interest rates
rate <- c(4.5,
4.12,
2.5,
3.8,
4.42,
3.84,
4.25,
4.41)
# current balances
invest <- c(1.75,
79.9,
1.0,
57.564,
81.1,
164.617,
165.797,
160)
sum(invest)
PERIOD <- (1:12)/12
# compute gain
gain <-  function(period){
sum(
invest * (1 + rate/100)^period  - invest
)
}
( g <- sapply(PERIOD, gain) )
n = 63
k = 27
k*(n-k)/2
k*(n-k)/4
?binom.test
?rbinom
size = k*(n-k)
rbinom(size)
N = k*(n-k)
rbinom(N,1,0.5)
rbinom(1,N,0.5)
rbinom(1000,N,0.5)
hist(x)
x <- rbinom(1000,N,0.5)
hist(x)
mean(x)
N/2
N/4
sd(x)
var(x)
58.75 * 50
58.75 * 50 + 370
setwd("~/Programming/Go/goformath/trees")
library(phytools)
newickFile <- "newick.txt"
# read file
tree <- read.tree(newickFile)
count <- tree$edge.length
# adjust parameters
eLength <- 2
tree$edge.length <- rep(eLength, nrow(tree$edge))
nedges <- nrow(tree$edge)
ntips <- length(tree$tip.label)
nnodes <- length(tree$node.label)
ncount <- rep(0, nnodes)
tcount <- rep(0, ntips)
for(i in 1:nedges){
k <- tree$edge[i,2] # find endpoint
if(k <= ntips){
# endpoint is a tip (i.e. a leaf)
#cat(sprintf("%s %d\n", tree$tip.label[k], count[i]))
tcount[k] <- count[i]
} else {
# endpoint is in internal node
#cat(sprintf("%s %d\n", tree$node.label[k - ntips], count[i]))
ncount[k - ntips] <- count[i]
}
}
ntext <- sapply(1:nnodes, function(i){
sprintf("%s(%d)", tree$node.label[i], ncount[i])
})
ttext <- sapply(1:ntips, function(i){
sprintf("%s(%d)", tree$tip.label[i], tcount[i])
})
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
#text=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=0.5)
nodelabels(text=ntext,
node=1:tree$Nnode+Ntip(tree),
frame="none",
adj=c(1.1,-0.4),
col="blue",
cex=0.5)
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
text=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=0.5)
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
labels=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=0.5)
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
text=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=0.5)
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
#text=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=0.5)
nodelabels(text=ntext,
node=1:tree$Nnode+Ntip(tree),
frame="none",
adj=c(1.1,-0.4),
col="blue",
cex=0.5)
nedges <- nrow(tree$edge)
ntips <- length(tree$tip.label)
nnodes <- length(tree$node.label)
ncount <- rep(1, nnodes)
tcount <- rep(1, ntips)
for(i in 1:nedges){
k <- tree$edge[i,2] # find endpoint
if(k <= ntips){
# endpoint is a tip (i.e. a leaf)
#cat(sprintf("%s %d\n", tree$tip.label[k], count[i]))
tcount[k] <- count[i]
} else {
# endpoint is in internal node
#cat(sprintf("%s %d\n", tree$node.label[k - ntips], count[i]))
ncount[k - ntips] <- count[i]
}
}
ntext <- sapply(1:nnodes, function(i){
sprintf("%s(%d)", tree$node.label[i], ncount[i])
})
ttext <- sapply(1:ntips, function(i){
sprintf("%s(%d)", tree$tip.label[i], tcount[i])
})
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
#text=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=ttext)
ttext
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
#text=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=tcount)
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
#text=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=log(tcount))
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
#text=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=tcount/max(tcount))
nodelabels(text=ntext,
node=1:tree$Nnode+Ntip(tree),
frame="none",
adj=c(1.1,-0.4),
col="blue",
cex=ncount/max(ncount))
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
#text=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=2*tcount/max(tcount))
nodelabels(text=ntext,
node=1:tree$Nnode+Ntip(tree),
frame="none",
adj=c(1.1,-0.4),
col="blue",
cex=2*ncount/max(ncount))
ntext <- sapply(1:nnodes, function(i){
#sprintf("%s(%d)", tree$node.label[i], ncount[i])
sprintf("%s", tree$node.label[i])
})
ttext <- sapply(1:ntips, function(i){
#sprintf("%s(%d)", tree$tip.label[i], tcount[i])
sprintf("%s", tree$tip.label[i])
})
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
#text=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=2*tcount/max(tcount))
nodelabels(text=ntext,
node=1:tree$Nnode+Ntip(tree),
frame="none",
adj=c(1.1,-0.4),
col="blue",
cex=2*ncount/max(ncount))
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
#text=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=5*tcount/max(tcount))
nodelabels(text=ntext,
node=1:tree$Nnode+Ntip(tree),
frame="none",
adj=c(1.1,-0.4),
col="blue",
cex=5*ncount/max(ncount))
ntext <- sapply(1:nnodes, function(i){
sprintf("%s(%d)", tree$node.label[i], ncount[i])
#sprintf("%s", tree$node.label[i])
})
ttext <- sapply(1:ntips, function(i){
sprintf("%s(%d)", tree$tip.label[i], tcount[i])
#sprintf("%s", tree$tip.label[i])
})
# plot tree
plot(tree,
type='cladogram',
no.margin=TRUE,
#text=ttext,
edge.width=1,
edge.color="grey",
tip.color="blue",
cex=0.5)
nodelabels(text=ntext,
node=1:tree$Nnode+Ntip(tree),
frame="none",
adj=c(1.1,-0.4),
col="blue",
cex=0.5)
